6c6
< : ${CKAN_SQLALCHEMY_URL:=}
---
> : "${CKAN_SQLALCHEMY_URL:=}"
8c8
< : ${CKAN_SOLR_URL:=}
---
> : "${CKAN_SOLR_URL:=}"
10c10
< : ${CKAN_REDIS_URL:=}
---
> : "${CKAN_REDIS_URL:=}"
12c12
< : ${CKAN_DATAPUSHER_URL:=}
---
> : "${CKAN_DATAPUSHER_URL:=}"
25a26,27
>   export CKAN_SOLR_USER=${CKAN_SOLR_USER}
>   export CKAN_SOLR_PASSWORD=${CKAN_SOLR_PASSWORD}
36a39,52
> 
>   export CKAN_OAUTH2_AUTHORIZATION_ENDPOINT=${CKAN_OAUTH2_AUTHORIZATION_ENDPOINT}
>   export CKAN_OAUTH2_TOKEN_ENDPOINT=${CKAN_OAUTH2_TOKEN_ENDPOINT}
>   export CKAN_OAUTH2_CLIENT_ID="${CKAN_OAUTH2_CLIENT_ID}"
>   export CKAN_OAUTH2_CLIENT_SECRET="${CKAN_OAUTH2_CLIENT_SECRET}"
>   export CKAN_OAUTH2_PROFILE_API_URL=${CKAN_OAUTH2_PROFILE_API_URL}
>   export CKAN_OAUTH2_SCOPE="${CKAN_OAUTH2_SCOPE}"
>   export CKAN_OAUTH2_PROFILE_API_USER_FIELD=${CKAN_OAUTH2_PROFILE_API_USER_FIELD}
>   export CKAN_OAUTH2_PROFILE_API_MAIL_FIELD=${CKAN_OAUTH2_PROFILE_API_MAIL_FIELD}
> 
>   export CKAN_PRIVATE_ORGS=${CKAN_PRIVATE_ORGS}
> 
>   export OAUTHLIB_INSECURE_TRANSPORT=${OAUTHLIB_INSECURE_TRANSPORT}
>   export OAUTHLIB_RELAX_TOKEN_SCOPE=${OAUTHLIB_RELAX_TOKEN_SCOPE}
44,48d59
< # Wait for PostgreSQL
< while ! pg_isready -h db -U ckan; do
<   sleep 1;
< done
< 
67,70d77
< if [ -z "$CKAN_DATAPUSHER_URL" ]; then
<     abort "ERROR: no CKAN_DATAPUSHER_URL specified in docker-compose.yml"
< fi
< 
72a80
> ckan --config "$CONFIG" search-index rebuild 
